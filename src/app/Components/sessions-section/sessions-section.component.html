<div class="sessions-section">
  <div class="sessions-container" *ngIf="displayedVideos.length>0">
    <ng-container *ngIf="!isLoading && !error; else loadingOrError">
      <div class="video-tabs" role="tablist">
        <ng-container *ngFor="let video of displayedVideos; let i = index">
          <div
            (click)="changeTab(i)"
            [class.active]="activeTab === i"
            class="video-tab"
            role="tab"
            [attr.aria-selected]="activeTab === i"
            [attr.tabindex]="activeTab === i ? 0 : -1"
          >
            <i class="fas fa-play-circle"></i>
            <div class="tab-content">
              <span class="tab-title" [title]="video.title">
                {{ getFirstWords(video.title, 5) }}
              </span>
              <span class="video-duration" *ngIf="video.duration">
                {{ video.duration }}
              </span>
            </div>
          </div>
        </ng-container>
      </div>

      <div class="content-grid">
        <div class="video-player">
          <div class="aspect-ratio-container">
            <iframe
              *ngIf="getActiveVideo()"
              [src]="getSafeYouTubeUrl(getActiveVideo()!.link)"
              frameborder="0"
              allow="accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>
        </div>
        <div class="video-info">
          <h2 class="video-title">{{ getActiveVideo()?.title }}</h2>
          <p class="video-description" [innerHTML]="getFirstWords(getActiveVideo()?.description || '', 90) ">
          </p>
          <a [routerLink]="['/sessions']" class="view-all-btn">
            View All Videos
          </a>
        </div>
      </div>
    </ng-container>

    <ng-template #loadingOrError>
      <div class="status-container">
        <div *ngIf="isLoading" class="loading-spinner">
          <i class="fas fa-spinner fa-spin"></i>
          Loading videos...
        </div>
        <div *ngIf="error" class="error-message">
          <i class="fas fa-exclamation-circle"></i>
          {{ error }}
          <button (click)="fetchVideos()" class="retry-btn">Retry</button>
        </div>
      </div>
    </ng-template>
  </div>
</div>